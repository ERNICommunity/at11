<!DOCTYPE html>
<html lang="sk">
<head>
    <meta charset="UTF-8">
    <title>@11</title>
    <link rel="icon" type="image/x-icon" href="img/favicon.ico" />
    <meta name="description" content="Obedové menu pri ERNI SK">

    <link rel="stylesheet" href="//netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
    <script src="//netdna.bootstrapcdn.com/bootstrap/3.1.1/js/bootstrap.min.js"></script>

    <link href="css/style2.css" type="text/css" rel="stylesheet">
    <link href="//netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" rel="stylesheet">
</head>
<body>
    <script type="text/javascript">
        $(function () {
            selectRestaurant(GetCookie("restaurant") || 1);

            $(document).keyup(function (e) {
                e.preventDefault();

                if (e.keyCode == 38) { //UP arrow
                    var selectedRestaurant = parseInt(findSelectedRestaurantId());
                    var restaurantCount = $('#navigationBar li').length + 1;

                    unSelectRestaurant(selectedRestaurant);
                    selectedRestaurant = (selectedRestaurant - 1 + restaurantCount) % restaurantCount;
                    if (selectedRestaurant == 0) selectedRestaurant = restaurantCount - 1;
                    selectRestaurant(selectedRestaurant)

                }
                if (e.keyCode == 40) { //DOWN arrow
                    var selectedRestaurant = parseInt(findSelectedRestaurantId());
                    var restaurantCount = $('#navigationBar li').length + 1;

                    unSelectRestaurant(selectedRestaurant);
                    selectedRestaurant = (selectedRestaurant + 1) % restaurantCount;
                    if (selectedRestaurant == 0) selectedRestaurant = 1;
                    selectRestaurant(selectedRestaurant)
                }

                if (e.keyCode == 13) { //ENTER
                    window.open($("li.active > a").data("url"), '_blank');
                }

            });

            $('a[data-toggle="pill"]').on('shown.bs.tab', function (e) {
                SetCookie("restaurant", $(this).attr("href").slice("#restaurant".length), 365);
            })
            $('a[data-toggle="pill"]').parent().on('click', function (e) {
                if ($(this).hasClass("active")) {
                    window.open($("li.active > a").data("url"), '_blank');
                }
            })

        });

        function selectRestaurant(id) {
            $('#navigationBar li a[href="\\#restaurant' + id + '"]').parent().addClass('active');
            $('#restaurant' + id).addClass('active');
            SetCookie("restaurant", id, 365);
        }

        function unSelectRestaurant(id) {
            $('#navigationBar li a[href="\\#restaurant' + id + '"]').parent().removeClass('active');
            $('#restaurant' + id).removeClass('active');
        }

        function findSelectedRestaurantId() {
            var activeRestaurant = $('#navigationBar .active').children().get(0);
            return $(activeRestaurant).attr('href').slice("#restaurant".length)
        }

        function SetCookie(cookieName, cookieValue, nDays) {
            var today = new Date();
            var expire = new Date();
            if (!nDays) { nDays = 1; }
            expire.setTime(today.getTime() + 3600000 * 24 * nDays);
            document.cookie = cookieName + "=" + escape(cookieValue)
                         + ";expires=" + expire.toGMTString() + ";path=/";
        }

        function GetCookie(cookieName) {
            var i, x, y, ARRcookies = document.cookie.split("; ");
            for (i = 0; i < ARRcookies.length; i++) {
                x = ARRcookies[i].substr(0, ARRcookies[i].indexOf("="));
                y = ARRcookies[i].substr(ARRcookies[i].indexOf("=") + 1);
                x = x.replace(/^\s+|\s+$/g, "");
                if (x == cookieName) {
                    return unescape(y);
                }
            }
        }
    </script>

    <div class="container-fluid well">

        <div class="fluid-row">
            <div class="col-md-2 col-md-offset-1 vcenter">
                <h1>Dnešné menu</h1>
            </div>
            <div class="col-md-2 vcenter">
                <h3>{{date}}</h3>
            </div>
        </div>

    </div>

    <div class="container-fluid">

        <div class="row-fluid">
            <div class="col-md-12">
                <form style="float: right; margin-right: 20px;">
                    <input type="hidden" name="theme" value="index" />
                    <button type="submit" class="btn btn-lg">Prepnúť tému</button>
                </form>
            </div>
        </div>

        <div class="row-fluid" style="margin-left: 20px;">

            <ul id="navigationBar" class="nav nav-pills nav-stacked col-md-2">
                {{#each restaurants}}
            <li><a href="#restaurant{{this.id}}" style="outline: 0;" data-toggle="pill" data-url="{{this.url}}">{{this.name}}</a></li>
                {{/each}}
            </ul>
            <div class="tab-content col-md-10">
                {{#each restaurants}}
            <div class="tab-pane" id="restaurant{{this.id}}" style="max-width: 1200px;">
                <ul class="food">
                    {{#each this.menu}}
                        {{#if this.isError}}
                        <li class="bg-danger error text-danger">
                            {{this.text}}
                        </li>
                        {{else}}                       
                        <li {{#if this.isSoup}}style="font-weight: bold;"{{/if}}>
                            {{{this.text}}}
                            <div style="float: right; display: inline-block;">
                                {{this.price}}
                            </div>
                        </li>
                        {{/if}}
                    {{else}}
                    <li class="bg-danger error"><p class="text-danger">Nepodarilo sa načítať menu, skús pozrieť priamo na stránke reštaurácie.</p></li>
                    {{/each}}
                </ul>

            </div>
                {{/each}}
            </div>
        </div>
    </div>

    <nav class="navbar navbar-default navbar-fixed-bottom visible-lg" role="navigation" style="font-size: 15px;">
        <div class="container-fluid">
            <div class="row">

                <div>

                    <div class="alert alert-warning">
                        <b>Tip:</b> na navigáciu medzi reštauráciami môžete použiť šípky <i>HORE</i>
                        a
                    <i>DOLE</i>, <i>ENTER</i> alebo druhé kliknutie na reštauráciu otvorí web vybranej reštaurácie.
                    </div>

                    <div class="row well">
                        <div class="col-md-2">
                            <a href="http://en.wikipedia.org/wiki/Copyleft" target="_blank" title="copyleft"
                                style="display: inline-block; -webkit-transform: scaleX(-1); transform: scaleX(-1);">©</a>
                            ALL WRONGS RESERVED
                        </div>
                        <div class="col-md-1 col-md-offset-9">
                            <a style="float: right" href="https://github.com/jakub-sturc/at11" target="_blank"
                                class="github">GitHub</a>
                        </div>
                    </div>
                </div>
            </div>

        </div>
    </nav>

    <!--<footer>-->
    <!--<div class="container visible-lg" style="position: fixed; bottom: 0; width: 100%; font-size: 15px;">-->
    <!--</div>-->

    <!--</footer>-->

</body>
</html>
