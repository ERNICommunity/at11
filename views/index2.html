<!DOCTYPE html>
<html lang="sk">
<head>
    <meta charset="UTF-8">
    <title>@11</title>
    <link rel="icon" type="image/x-icon" href="img/favicon.ico" />
    <meta name="description" content="Obedové menu pri ERNI SK">

    <link rel="stylesheet" href="//netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap.min.css">
    <link href="css/style2.css" type="text/css" rel="stylesheet">
    <link href="//netdna.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.css" rel="stylesheet">

    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
    <script src="//netdna.bootstrapcdn.com/bootstrap/3.1.1/js/bootstrap.min.js"></script>
    <script src="js/script2.js"></script>

    <script type="text/javascript">
        (function($) {
            $.fn.hasScrollBar = function() {
                return this.get(0).scrollHeight > this.get(0).clientHeight;
            };
        })(jQuery);

        $(function() {
            selectRestaurant(GetCookie("restaurant") || 1);

            if (!$('html').hasScrollBar())
            {
                $('#padding').addClass('hidden');
            }

            $(document).keyup(function(e) {
                e.preventDefault();

                if (e.keyCode === 38 || e.keyCode === 40)//UP or DOWN
                {
                    var selectedRestaurant = parseInt(findSelectedRestaurantId());
                    var restaurantCount = $('#navigationBar li').length + 1;

                    unSelectRestaurant(selectedRestaurant);
                    
                    if (e.keyCode === 38)
                    { //UP arrow
                        selectedRestaurant = (selectedRestaurant - 1 + restaurantCount) % restaurantCount;
                        if (selectedRestaurant === 0) selectedRestaurant = restaurantCount - 1;
                    }
                    if (e.keyCode === 40)
                    { //DOWN arrow
                        selectedRestaurant = (selectedRestaurant + 1) % restaurantCount;
                        if (selectedRestaurant === 0) selectedRestaurant = 1;
                    }
                    
                    selectRestaurant(selectedRestaurant);
                }
                
                if (e.keyCode === 13)
                { //ENTER
                    window.open($("li.active > a").data("url"), '_blank');
                }

            });

            $('a[data-toggle="pill"]').on('shown.bs.tab', function() {
                SetCookie("restaurant", $(this).attr("href").slice("#restaurant".length), 365);
            });
            $('a[data-toggle="pill"]').parent().on('click', function() {
                if ($(this).hasClass("active"))
                {
                    window.open($("li.active > a").data("url"), '_blank');
                }
            });
        });

        function selectRestaurant(id) {
            $('#navigationBar li a[href="\\#restaurant' + id + '"]').parent().addClass('active');
            $('#restaurant' + id).addClass('active');
            SetCookie("restaurant", id, 365);
        }

        function unSelectRestaurant(id) {
            $('#navigationBar li a[href="\\#restaurant' + id + '"]').parent().removeClass('active');
            $('#restaurant' + id).removeClass('active');
        }

        function findSelectedRestaurantId() {
            var activeRestaurant = $('#navigationBar .active').children().get(0);
            return $(activeRestaurant).attr('href').slice("#restaurant".length);
        }

        function SetCookie(cookieName, cookieValue, nDays) {
            var today = new Date();
            var expire = new Date();
            if (!nDays) { nDays = 1; }
            expire.setTime(today.getTime() + 3600000 * 24 * nDays);
            document.cookie = cookieName + "=" + escape(cookieValue) + ";expires=" + expire.toGMTString() + ";path=/";
        }

        function GetCookie(cookieName) {
            var i, x, y, ARRcookies = document.cookie.split("; ");
            for (i = 0; i < ARRcookies.length; i++)
            {
                x = ARRcookies[i].substr(0, ARRcookies[i].indexOf("="));
                y = ARRcookies[i].substr(ARRcookies[i].indexOf("=") + 1);
                x = x.replace(/^\s+|\s+$/g, "");
                if (x === cookieName)
                {
                    return unescape(y);
                }
            }
        }
    </script>
</head>
<body>
    <header>
        {{> header}}
    </header>
    <div class="container-fluid" style="margin-top: 89px;">
        <div class="row">
            <div class="col-xs-3">
                <ul id="navigationBar" class="nav nav-pills nav-stacked">
                    {{#each restaurants}}
            <li><a href="#restaurant{{this.id}}" data-toggle="pill" data-url="{{this.url}}">{{this.name}}</a></li>
                    {{/each}}
                </ul>
            </div>

            <div class="tab-content col-xs-9">
                {{#each restaurants}}
                <div class="tab-pane" id="restaurant{{this.id}}" data-restaurant-id="{{this.id}}" style="max-width: 1200px;">
                    <div class="fa fa-spinner fa-spin"></div>
                </div>
                {{/each}}
            </div>
        </div>
    </div>
    <div class="container-fluid" id="padding" style="font-size: 15px;">
        <div class="row" style="min-height: 15px;"></div>
        <div class="alert alert-warning visible-md visible-lg row">
            <b>Tip:</b> na navigáciu medzi reštauráciami môžete použiť šípky <i>HORE</i>
            a <i>DOLE</i>, <i>ENTER</i> alebo druhé kliknutie na reštauráciu otvorí web vybranej reštaurácie.
        </div>
        <div class="row well" style="margin-bottom: 0px;">
            <span>.</span>
        </div>
    </div>
    <footer>{{> footer}}</footer>
</body>
</html>
